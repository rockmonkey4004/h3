{% comment %}
To use this include, add toc: true to your front matter
Then include this file in your post with: {% include toc.html %}
{% endcomment %}

{% if page.toc %}
<div class="toc-container">
  <div class="toc">
    <h2>Table of Contents</h2>
    <ul id="markdown-toc">
      {% assign headers = content | split: '<h2' %}
      {% for header in headers %}
        {% if forloop.first == false %}
          {% assign headerContent = header | split: '</h2>' | first %}
          {% assign headerTitle = headerContent | split: '>' | last | strip_html %}
          {% assign headerLink = headerTitle | slugify %}
          <li>
            <a href="#{{ headerLink }}">{{ headerTitle }}</a>
            
            {% assign subheaders = header | split: '<h3' %}
            {% if subheaders.size > 1 %}
              <ul>
                {% for subheader in subheaders %}
                  {% if forloop.first == false %}
                    {% assign subheaderContent = subheader | split: '</h3>' | first %}
                    {% assign subheaderTitle = subheaderContent | split: '>' | last | strip_html %}
                    {% assign subheaderLink = subheaderTitle | slugify %}
                    <li>
                      <a href="#{{ subheaderLink }}">{{ subheaderTitle }}</a>
                    </li>
                  {% endif %}
                {% endfor %}
              </ul>
            {% endif %}
          </li>
        {% endif %}
      {% endfor %}
    </ul>
  </div>
</div>

<style>
  .toc-container {
    border: 1px solid #e8e8e8;
    background-color: #f9f9f9;
    padding: 15px;
    margin-bottom: 30px;
    border-radius: 5px;
  }
  
  .toc h2 {
    font-size: 1.5em;
    margin-top: 0;
    margin-bottom: 10px;
  }
  
  #markdown-toc {
    list-style-type: decimal;
    margin-left: 20px;
  }
  
  #markdown-toc ul {
    list-style-type: disc;
    margin-left: 15px;
  }
  
  .toc a {
    text-decoration: none;
    color: #2a7ae2;
  }
  
  .toc a:hover {
    text-decoration: underline;
  }
</style>

<script>
  // Add IDs to h2 and h3 elements for TOC links
  document.addEventListener('DOMContentLoaded', function() {
    const headers = document.querySelectorAll('.blog-content h2, .blog-content h3');
    headers.forEach(header => {
      const id = header.textContent.trim().toLowerCase().replace(/\s+/g, '-');
      header.id = id;
    });
  });
</script>
{% endif %} 